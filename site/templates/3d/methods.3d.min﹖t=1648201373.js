var methods=function(e){"use strict";let t=!1;return e.display=function(e,i={}){const n={debug:!!i.debug,zoom:i.zoom&&isFinite(i.zoom)&&i.zoom>0?i.zoom:15,count:i.count&&isFinite(i.count)&&i.count>0?i.count:5,angle:i.angle&&isFinite(i.angle)?i.angle:-90,animTime:i.animTime&&isFinite(i.animTime)&&i.animTime>0?i.animTime:1,animHold:i.animHold&&isFinite(i.animHold)&&i.animHold>0?i.animHold:3,animDelay:i.animDelay&&isFinite(i.animDelay)&&i.animDelay>0?i.animDelay:3,height:i.height&&isFinite(i.height)&&i.height>0?i.height:100,heightRef:"height"===i.heightRef?"height":"width"},a=new THREE.Vector2(100,100),o=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),s=new THREE.Scene,l=new THREE.OrthographicCamera,r=new THREE.Clock,d=new THREE.BoxGeometry(1,1,1),m=new THREE.PlaneGeometry(1,1,1),h=new THREE.MeshStandardMaterial({color:16118509}),c=new THREE.MeshStandardMaterial({color:16118509,depthTest:!1,depthWrite:!1,depthFunc:THREE.AlwaysDepth}),E=new THREE.Group;let u=0,g=0,p=0,R=!0,T=!1;function y(){T=!1;let t=e.getBoundingClientRect();"width"===n.heightRef?a.set(t.width,t.width*(n.height/100)):a.set(t.width,t.height*(n.height/100)),a.aspect=a.x/a.y,a.x>a.y?(l.top=n.zoom/2,l.bottom=n.zoom/-2,l.left=n.zoom*a.aspect/-2,l.right=n.zoom*a.aspect/2):(l.left=n.zoom/-2,l.right=n.zoom/2,l.top=n.zoom/a.aspect/2,l.bottom=n.zoom/a.aspect/-2),l.updateProjectionMatrix(),o.setSize(a.x,a.y)}function f(){T||(T=!0,requestAnimationFrame(y))}i.cubes&&Array.isArray(i.cubes)&&(n.count=Math.max(n.count,i.cubes.length));let H=new THREE.InstancedMesh(d,h,n.count),w=new THREE.Matrix4,A=[],D=[];function M(e,t,i){let n=!1;return A.length?(n=A.pop(),n.visible=!0):(n=new THREE.Mesh(m,c),D.push(n),E.add(n)),n.position.set(e,t,i),n}function z(e,t){let i=0;for(let n=0;n<e.length;n++)!Array.isArray(e[n])||e[n].length<3||(i+=1,e[n][0]+=t[0],e[n][1]+=t[1],e[n][2]+=t[2],4===e[n].length&&"string"==typeof e[n][3]&&(e[n][3].includes("+y")&&M(e[n][0]+0,e[n][1]+.5,e[n][2]+0).rotation.set(-90*THREE.MathUtils.DEG2RAD,0,0),e[n][3].includes("-y")&&M(e[n][0]+0,e[n][1]-.5,e[n][2]+0).rotation.set(90*THREE.MathUtils.DEG2RAD,0,0),e[n][3].includes("+x")&&M(e[n][0]+.5,e[n][1]+0,e[n][2]+0).rotation.set(0,90*THREE.MathUtils.DEG2RAD,0),e[n][3].includes("-x")&&M(e[n][0]-.5,e[n][1]+0,e[n][2]+0).rotation.set(0,-90*THREE.MathUtils.DEG2RAD,0),e[n][3].includes("+z")&&M(e[n][0]+0,e[n][1]+0,e[n][2]+.5).rotation.set(0,0,0),e[n][3].includes("-z")&&M(e[n][0]+0,e[n][1]+0,e[n][2]-.5).rotation.set(-180*THREE.MathUtils.DEG2RAD,0,0)),w.makeTranslation(e[n][0],e[n][1],e[n][2]),H.setMatrixAt(n,w));H.count=i,H.instanceMatrix.needsUpdate=!0}if(z(i.cubes&&Array.isArray(i.cubes)?i.cubes:[],i.position&&Array.isArray(i.position)&&3===i.position.length?i.position:[0,0,0]),E.add(H),s.add(E),i.debug){let e=new THREE.Mesh(d,new THREE.MeshStandardMaterial({color:16711680,opacity:.5,transparent:!0,depthTest:!1,depthFunc:THREE.AlwaysDepth}));e.scale.set(.5,.5,.5),E.add(e)}o.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),e.appendChild(o.domElement);const b=new THREE.AmbientLight("#ffffff",.8),x=new THREE.DirectionalLight("#ffffff",.3);if(x.position.set(20,100,50),x.lookAt(0,0,0),s.add(b),s.add(x),l.position.set(100,100,100),l.lookAt(0,0,0),requestAnimationFrame(y),requestAnimationFrame((function e(){var t;requestAnimationFrame(e),g=r.getDelta(),u+=g,u%=2*n.animTime+n.animDelay+n.animHold,p=Math.min(Math.max(0,(u-n.animDelay)/n.animTime),1,(2*n.animTime+n.animHold+n.animDelay-u)/n.animTime),E.rotation.set(0,(R?n.angle-n.angle*((t=p)<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2):n.angle)*THREE.MathUtils.DEG2RAD,0),o.render(s,l)})),window.addEventListener("resize",f),(i.debug||i.controls)&&dat){t||(t=new dat.GUI);const e=t.addFolder("Display");e.open(),e.add(n,"zoom",5,50,.1).onChange(f),e.add(n,"angle",-360,360,1),e.add(n,"animTime",0,5,.1),e.add(n,"animHold",0,5,.1),e.add(n,"animDelay",0,5,.1)}return{update:function(e,t){for(let e=0;e<D.length;e++)A.push(D[e]),D[e].visible=!1;z(e&&Array.isArray(e)?e:[],t&&Array.isArray(t)&&3===t.length?t:[0,0,0])},zoom:function(e){n.zoom=e,f()},angle:function(e){isFinite(e)&&(n.angle=e)},animate:function(e){R=!!e}}},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
